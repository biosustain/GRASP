

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>Compute Gibbs free energy ranges &mdash; GRASP 2.0.0 documentation</title>
  

  
  
  
  
  
  
  
  
  <meta name="theme-color" content="#ffffff">


  <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.2.1/jquery.min.js"></script>
  <script src="https://code.jquery.com/jquery-1.11.2.min.js"></script>
  <script src="../../_static/js/jquery.easy-autocomplete.min.js" type="text/javascript" ></script>

    <script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js"></script>
  
  <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css">
  <link href='https://fonts.googleapis.com/css?family=Lato:400,700|Roboto+Slab:400,700|Inconsolata:400,700' rel='stylesheet' type='text/css'>
  <link href="../../_static/css/easy-autocomplete.min.css" rel="stylesheet" type="text/css">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css">

  
  
    

  

  
  
    <link rel="stylesheet" href="../../_static/css/cobra.css" type="text/css" />
  

  
    <link rel="stylesheet" href="../../_static/pygments.css" type="text/css" />
  
    <link rel="stylesheet" href="../../_static/css/cobra.css" type="text/css" />
  

  
        <link rel="index" title="Index"
              href="../../genindex.html"/>
        <link rel="search" title="Search" href="../../search.html"/>
    <link rel="top" title="GRASP 2.0.0 documentation" href="../../index.html"/>
        <link rel="up" title="Ensemble functions" href="../ensemble_functions.html"/>
        <link rel="next" title="Compute robust fluxes" href="compute_robust_fluxes.html"/>
        <link rel="prev" title="Check stability" href="check_stability.html"/> 

  
  <script src="../../_static/js/modernizr.min.js"></script>
</head>

<body class="wy-body-for-nav" role="document">

   
  <div class="wy-grid-for-nav">

    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search">
          

          
            <a href="../../index.html" class="icon icon-home"> GRASP
          

          
          </a>
          <h1>GRASP</h1>

          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" id="simple"/>
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
    <script>
    	var options = {

		url: "../../_static/json/functions.json",

		getValue: "name",

		list: {
            onKeyEnterEvent: function(item) {
                    return "_static/../" + item.website_url
            },
            maxNumberOfElements: 25,
			match: {
					enabled: true,
			},
            sort: {
			    enabled: true
		    }
		},

    	template: {
	    	type: "custom",
		    method: function(value, item) {
                return "<span><a href='../../search.html?q=" + item.name + "&check_keywords=yes&area=default'>" + value + "</a>" + "<a href='../../_static/../" + item.website_url + "' ><img src='../../_static/link.svg'/></a></span>";
		    }
	    },

		theme: "square"

	};

	$("#simple").easyAutocomplete(options);


    </script>
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
              <ul class="current">
                  <li class="toctree-l1"><a class="reference internal" href="../../index.html">Home</a></li>
              </ul>
              <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../../installation.html">Installation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../how_to_build_a_model.html">How to build a model</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../model_analysis.html">Model analysis</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../visualization.html">Visualizing results</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../tutorials.html">Tutorials</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../troubleshoot.html">Troubleshooting</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="../../api_doc.html">API documentation</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="../analysis_functions.html">Analysis functions</a></li>
<li class="toctree-l2 current"><a class="reference internal" href="../ensemble_functions.html">Ensemble functions</a><ul class="current">
<li class="toctree-l3"><a class="reference internal" href="add_kinetic_fxns_to_path.html">Add kinetic functions to path</a></li>
<li class="toctree-l3"><a class="reference internal" href="build_ensemble.html">Build ensemble</a></li>
<li class="toctree-l3"><a class="reference internal" href="check_stability.html">Check stability</a></li>
<li class="toctree-l3 current"><a class="current reference internal" href="#">Compute Gibbs free energy ranges</a></li>
<li class="toctree-l3"><a class="reference internal" href="compute_robust_fluxes.html">Compute robust fluxes</a></li>
<li class="toctree-l3"><a class="reference internal" href="export_SBML.html">Export model to SBML</a></li>
<li class="toctree-l3"><a class="reference internal" href="extract_prior.html">Extract prior</a></li>
<li class="toctree-l3"><a class="reference internal" href="find_issues_with_TMFA.html">Find issues with TMFA</a></li>
<li class="toctree-l3"><a class="reference internal" href="fix_variable_names.html">Fix variable names</a></li>
<li class="toctree-l3"><a class="reference internal" href="general_HR.html">General Hit-and-Run sampler</a></li>
<li class="toctree-l3"><a class="reference internal" href="initial_sampler.html">Initial sampler</a></li>
<li class="toctree-l3"><a class="reference internal" href="initialize_ensemble.html">Initialize ensemble</a></li>
<li class="toctree-l3"><a class="reference internal" href="load_ensemble_structure.html">Load ensemble structure</a></li>
<li class="toctree-l3"><a class="reference internal" href="pool_constraint_fxn.html">Pool constraint function</a></li>
<li class="toctree-l3"><a class="reference internal" href="sample_allostery.html">Sample allostery</a></li>
<li class="toctree-l3"><a class="reference internal" href="sample_enzyme_abundances.html">Sample enzyme abundances</a></li>
<li class="toctree-l3"><a class="reference internal" href="sample_flux_and_gibbs_free_energies.html">Sample fluxes and Gibbs free energies for each model</a></li>
<li class="toctree-l3"><a class="reference internal" href="sample_general_reversibilities.html">Sample general reversibilities</a></li>
<li class="toctree-l3"><a class="reference internal" href="sample_modifier_elem_fluxes.html">Sample modifier elementary fluxes</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../pattern_functions.html">Pattern functions</a></li>
<li class="toctree-l2"><a class="reference internal" href="../simulation_viz.html">Simulation visualization</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../how_to_contribute.html">How to contribute</a></li>
</ul>

          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" role="navigation" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../index.html">GRASP</a>
        
      </nav>


      
      <div class="wy-nav-content">
        <div class="rst-content">
          

















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="../../index.html" class="icon icon-home"></a> &raquo;</li>
        
          <li><a href="../../api_doc.html">API documentation</a> &raquo;</li>
        
          <li><a href="../ensemble_functions.html">Ensemble functions</a> &raquo;</li>
        
      <li>Compute Gibbs free energy ranges</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
          
            <a href="../../_sources/api_doc/ensembleFxns/compute_gibbs_free_energy_ranges.rst.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="https://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="compute-gibbs-free-energy-ranges">
<h1>Compute Gibbs free energy ranges<a class="headerlink" href="#compute-gibbs-free-energy-ranges" title="Permalink to this headline">¶</a></h1>
<dl class="mat function">
<dt class="sig sig-object mat" id="ensembleFxns.computeGibbsFreeEnergyRanges">
<span class="sig-name descname"><span class="pre">computeGibbsFreeEnergyRanges</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="pre">ensemble</span></em>, <em class="sig-param"><span class="pre">DGr_std_min</span></em>, <em class="sig-param"><span class="pre">DGr_std_max</span></em>, <em class="sig-param"><span class="pre">vmin</span></em>, <em class="sig-param"><span class="pre">vmax</span></em>, <em class="sig-param"><span class="pre">xmin</span></em>, <em class="sig-param"><span class="pre">xmax</span></em>, <em class="sig-param"><span class="pre">ineqConstraints</span></em><span class="sig-paren">)</span><a class="headerlink" href="#ensembleFxns.computeGibbsFreeEnergyRanges" title="Permalink to this definition">¶</a></dt>
<dd><p>Applies Thermodynamic Flux Balance Analysis (TMFA) to find
thermodynamically feasible ranges for reactions fluxes, metabolite
concentrations, and reactions Gibbs energies.</p>
<p>It is based on <a class="reference external" href="https://arxiv.org/pdf/1803.04999.pdf">https://arxiv.org/pdf/1803.04999.pdf</a></p>
<p>We add a constraint to ensure that the sum of the dG values
for all reactions involved in a close loop is zero.</p>
<p>Note: The value for K is now decreased if the initial point to use for
sampling gibbs energies and fluxes is thermodynamically infeasible
(Gibbs energies and reaction fluxes are not compatible).
This happens sometimes because of numerical precision issues.
For instance, intlinprog considers anything lower than
1e-6 to be the same as zero. Thus, it is possible to have
a constraint like -dGr -K*e &lt;= -1e-6, if dGr = -10, K = 1e10,
and e= 1e-7 the constraint is satisfied, even though it wouldn’t
be if e=0. In this case e should be 1, which is not the case
due to numerical imprecision. Thus, in this case, K would be set
to 1e7, so that K*e &gt;= 10^0 is true even when e=1e-7, forcing e
to be 1 when it should be 1, e.g. to satisfy -dGr -K*e &lt;= -1e-6,
with dGr = -10, K = 1e7.</p>
<p><strong>Usage</strong></p>
<blockquote>
<div><p>[v_range,DGr_range,DGf_std_range,lnx_range,x0] = computeGibbsFreeEnergyRanges(ensemble,DGr_std_min,DGr_std_max,vmin,vmax,xmin,xmax,ineqConstraints)</p>
</div></blockquote>
<p><strong>Inputs</strong></p>
<blockquote>
<div><ul class="simple">
<li><p><strong>ensemble</strong> (<em>struct</em>) –
model ensemble, see buildEnsemble for fields description</p></li>
<li><p><strong>DGr_std_min</strong> (<em>double vector</em>) –
minimum values for standard reaction Gibbs energies</p></li>
<li><p><strong>DGr_std_max</strong> (<em>double vector</em>) –
maximum values for standard reaction Gibbs energies</p></li>
<li><p><strong>vmin</strong> (<em>double vector</em>) –
minimum values for reaction fluxes</p></li>
<li><p><strong>vmax</strong> (<em>double vector</em>) –
maximum values for reaction fluxes</p></li>
<li><p><strong>xmin</strong> (<em>double vector</em>) –
minimum values for metabolite concentrations</p></li>
<li><p><strong>xmax</strong> (<em>double vector</em>) –
maximu values for metabolite concentrations</p></li>
<li><p><strong>ineqConstraints</strong> (<em>double</em>) –
inequality constraints</p></li>
</ul>
</div></blockquote>
<p><strong>Outputs</strong></p>
<blockquote>
<div><ul class="simple">
<li><p><strong>v_range</strong> (<em>double matrix</em>) –
range of feasible reaction fluxes</p></li>
<li><p><strong>DGr_range</strong> (<em>double matrix</em>) –
range of feasible Gibbs energies</p></li>
<li><p><strong>DGr_std_range</strong> (<em>double matrix</em>) –
range of feasible standard reaction Gibbs energies</p></li>
<li><p><strong>lnx_range</strong> (<em>double matrix</em>) –
range of feasible metabolite concentrations (ln)</p></li>
<li><p><strong>x0</strong> (<em>double matrix</em>) –
initial point to be used for the sampling with hit-and-run method</p></li>
</ul>
</div></blockquote>
</dd></dl>

</div>


           </div>
           <div class="articleComments">
            
           </div>
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="compute_robust_fluxes.html" class="btn btn-default float-right" title="Compute robust fluxes" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="check_stability.html" class="btn btn-default" title="Check stability" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2016-2019, The GRASP developers.

    </p>
  </div>
  Built with Sphinx using a <a href="https://github.com/snide/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  

  

    <script type="text/javascript">
        var DOCUMENTATION_OPTIONS = {
            URL_ROOT:'../../',
            VERSION:'2.0.0',
            COLLAPSE_INDEX:false,
            FILE_SUFFIX:'.html',
            HAS_SOURCE:  true,
            SOURCELINK_SUFFIX: '.txt'
        };
    </script>
    <script type="text/javascript" src="../../_static/documentation_options.js"></script>
    <script type="text/javascript" src="../../_static/jquery.js"></script>
    <script type="text/javascript" src="../../_static/underscore.js"></script>
    <script type="text/javascript" src="../../_static/doctools.js"></script>

  


  
  
    <script type="text/javascript" src="../../_static/js/theme.js"></script>
  

  
  
  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.StickyNav.enable();
      });
  </script>
   

</body>
</html>