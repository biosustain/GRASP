

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>Model analysis &mdash; GRASP 2.0.0 documentation</title>
  

  
  
  
  
  
  
  
  
  <meta name="theme-color" content="#ffffff">


  <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.2.1/jquery.min.js"></script>
  <script src="https://code.jquery.com/jquery-1.11.2.min.js"></script>
  <script src="_static/js/jquery.easy-autocomplete.min.js" type="text/javascript" ></script>

    <script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js"></script>
  
  <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css">
  <link href='https://fonts.googleapis.com/css?family=Lato:400,700|Roboto+Slab:400,700|Inconsolata:400,700' rel='stylesheet' type='text/css'>
  <link href="_static/css/easy-autocomplete.min.css" rel="stylesheet" type="text/css">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css">

  
  
    

  

  
  
    <link rel="stylesheet" href="_static/css/cobra.css" type="text/css" />
  

  

  
        <link rel="index" title="Index"
              href="genindex.html"/>
        <link rel="search" title="Search" href="search.html"/>
    <link rel="top" title="GRASP 2.0.0 documentation" href="index.html"/>
        <link rel="next" title="Visualizing results" href="visualization.html"/>
        <link rel="prev" title="How to build a model" href="how_to_build_a_model.html"/> 

  
  <script src="_static/js/modernizr.min.js"></script>
</head>

<body class="wy-body-for-nav" role="document">

   
  <div class="wy-grid-for-nav">

    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search">
          

          
            <a href="index.html" class="icon icon-home"> GRASP
          

          
          </a>
          <h1>GRASP</h1>

          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" id="simple"/>
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
    <script>
    	var options = {

		url: "_static/json/functions.json",

		getValue: "name",

		list: {
            onKeyEnterEvent: function(item) {
                    return "_static/../" + item.website_url
            },
            maxNumberOfElements: 25,
			match: {
					enabled: true,
			},
            sort: {
			    enabled: true
		    }
		},

    	template: {
	    	type: "custom",
		    method: function(value, item) {
                return "<span><a href='search.html?q=" + item.name + "&check_keywords=yes&area=default'>" + value + "</a>" + "<a href='_static/../" + item.website_url + "' ><img src='_static/link.svg'/></a></span>";
		    }
	    },

		theme: "square"

	};

	$("#simple").easyAutocomplete(options);


    </script>
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
              <ul class="current">
                  <li class="toctree-l1"><a class="reference internal" href="index.html">Home</a></li>
              </ul>
              <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="installation.html">Installation</a></li>
<li class="toctree-l1"><a class="reference internal" href="how_to_build_a_model.html">How to build a model</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">Model analysis</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#simulating-the-model-ensemble">Simulating the model ensemble</a></li>
<li class="toctree-l2"><a class="reference internal" href="#metabolic-control-analysis-mca">Metabolic Control Analysis (MCA)</a></li>
<li class="toctree-l2"><a class="reference internal" href="#stability-analysis">Stability analysis</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="visualization.html">Visualizing results</a></li>
<li class="toctree-l1"><a class="reference internal" href="tutorials.html">Tutorials</a></li>
<li class="toctree-l1"><a class="reference internal" href="how_to_contribute.html">How to contribute</a></li>
<li class="toctree-l1"><a class="reference internal" href="api_doc.html">API documentation</a></li>
</ul>

          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" role="navigation" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="index.html">GRASP</a>
        
      </nav>


      
      <div class="wy-nav-content">
        <div class="rst-content">
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="index.html">Docs</a> &raquo;</li>
        
      <li>Model analysis</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
            <a href="_sources/model_analysis.rst.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="https://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="model-analysis">
<h1>Model analysis<a class="headerlink" href="#model-analysis" title="Permalink to this headline">¶</a></h1>
<p>Once a model ensemble has been generated by GRASP, we can easily:</p>
<blockquote>
<div><ul class="simple">
<li><p>simulate the models;</p></li>
<li><p>do metabolic control analysis;</p></li>
<li><p>do stability analysis.</p></li>
</ul>
</div></blockquote>
<div class="section" id="simulating-the-model-ensemble">
<h2>Simulating the model ensemble<a class="headerlink" href="#simulating-the-model-ensemble" title="Permalink to this headline">¶</a></h2>
<p>To simulate the model you can use the script <code class="docutils literal notranslate"><span class="pre">simulate_model.m</span></code> in the <code class="docutils literal notranslate"><span class="pre">examples</span></code> folder.</p>
<p>It is worth keeping in mind that GRASP uses scaled enzyme and metabolite concentrations. This is important when simulating perturbations.</p>
<p>While for enzymes, the concentrations are always scaled concentrations and any perturbations applied will be relative to the reference state (1), for metabolites perturbations can be defined either relative to the reference state (2) or in terms of absolute concentrations, by setting the variable <code class="docutils literal notranslate"><span class="pre">metsAbsOrRel</span></code> to <code class="docutils literal notranslate"><span class="pre">'rel'</span></code> or <code class="docutils literal notranslate"><span class="pre">'abs'</span></code>, respectively.</p>
<p>As an example, if the initial concentration for a given enzyme is set to <code class="docutils literal notranslate"><span class="pre">2</span></code>, this means its concentration will be twice its concentration in the reference state. The same is true for metabolites if <code class="docutils literal notranslate"><span class="pre">metsAbsOrRel</span></code> is set to <code class="docutils literal notranslate"><span class="pre">'rel'</span></code>.</p>
<p>If you want to define the initial concentration for a given metabolite in terms of absolute concentrations, <code class="docutils literal notranslate"><span class="pre">metsAbsOrRel</span></code> must be set to <code class="docutils literal notranslate"><span class="pre">'abs'</span></code> and the initial concentration must be specified in <code class="docutils literal notranslate"><span class="pre">mol/L</span></code>.</p>
<p>Other important variables to define are:</p>
<blockquote>
<div><ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">finalTime</span></code>:  the time of the simulation given in hours;</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">interruptTime</span></code>:  when the simulation will be aborted if it is still running, this time is specified in seconds. The idea is to skip simulations that take a long time to run;</p></li>
</ul>
</div></blockquote>
<p>Example:</p>
<div class="highlight-matlab notranslate"><div class="highlight"><pre><span></span><span class="c">% Add all GRASP functions to the Matlab path</span>
<span class="n">addpath</span><span class="p">(</span><span class="n">fullfile</span><span class="p">(</span><span class="s">&#39;..&#39;</span><span class="p">,</span> <span class="s">&#39;matlab_code&#39;</span><span class="p">,</span> <span class="s">&#39;patternFxns&#39;</span><span class="p">),</span> <span class="c">...</span>
        <span class="n">fullfile</span><span class="p">(</span><span class="s">&#39;..&#39;</span><span class="p">,</span> <span class="s">&#39;matlab_code&#39;</span><span class="p">,</span> <span class="s">&#39;ensembleFxns&#39;</span><span class="p">));</span>


<span class="c">% Define the model ID (file name of the model ensemble)</span>
<span class="n">modelID</span> <span class="p">=</span> <span class="s">&#39;toy_model&#39;</span><span class="p">;</span>

<span class="c">% Define the path to the input/output files</span>
<span class="n">outputFolder</span> <span class="p">=</span> <span class="n">fullfile</span><span class="p">(,</span> <span class="s">&#39;..&#39;</span><span class="p">,</span> <span class="s">&#39;io&#39;</span><span class="p">,</span> <span class="s">&#39;output&#39;</span><span class="p">);</span>

<span class="c">% Define how many seconds until ODE solver is interrupted. The idea is to</span>
<span class="c">% skip models that take ages to simulate.</span>
<span class="n">interruptTime</span> <span class="p">=</span> <span class="mi">40</span><span class="p">;</span>

<span class="c">% Load model ensemble previously generated</span>
<span class="n">load</span><span class="p">(</span><span class="n">fullfile</span><span class="p">(</span><span class="n">outputFolder</span><span class="p">,</span> <span class="p">[</span><span class="n">modelID</span><span class="p">,</span> <span class="s">&#39;.mat&#39;</span><span class="p">]))</span>


<span class="c">% Get default initial conditions, all ones</span>
<span class="n">freeVars</span> <span class="p">=</span> <span class="nb">numel</span><span class="p">(</span><span class="n">ensemble</span><span class="p">.</span><span class="n">freeVars</span><span class="p">);</span>
<span class="n">xopt</span> <span class="p">=</span> <span class="nb">ones</span><span class="p">(</span><span class="n">freeVars</span><span class="p">,</span><span class="mi">1</span><span class="p">);</span>
<span class="n">ix_mets</span> <span class="p">=</span> <span class="mi">1</span><span class="p">:</span> <span class="nb">numel</span><span class="p">(</span><span class="n">ensemble</span><span class="p">.</span><span class="n">metsActive</span><span class="p">);</span>
<span class="n">ix_enz</span> <span class="p">=</span> <span class="n">ix_mets</span><span class="p">(</span><span class="k">end</span><span class="p">)</span><span class="o">+</span><span class="mi">1</span><span class="p">:</span> <span class="n">freeVars</span><span class="p">;</span>
<span class="n">metsIC</span> <span class="p">=</span> <span class="n">xopt</span><span class="p">(</span><span class="n">ix_mets</span><span class="p">);</span>
<span class="n">enzymesIC</span> <span class="p">=</span> <span class="n">xopt</span><span class="p">(</span><span class="n">ix_enz</span><span class="p">);</span>

<span class="c">% Define whether the initial condition for metabolites is a relative or an</span>
<span class="c">% absolute concentration by setting metsAbsOrRel to either &#39;rel&#39; or &#39;abs&#39;,</span>
<span class="c">% respectively</span>
<span class="n">metsAbsOrRel</span> <span class="p">=</span> <span class="s">&#39;rel&#39;</span><span class="p">;</span>

<span class="c">% Change initial conditions here if you want</span>

<span class="c">% Setting relative concentration for enzyme number 2 to be 1.5x the initial one.</span>
<span class="n">enzymesIC</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span> <span class="p">=</span> <span class="mf">1.5</span><span class="p">;</span>
<span class="c">% Setting the relative metabolite concentrations for metabolite 5 to be 2x the initial one</span>
<span class="n">metsIC</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span> <span class="p">=</span> <span class="mi">2</span><span class="p">;</span>          <span class="c">% If metsAbsOrRel = &#39;abs&#39;, the  concentrations must be given in mol/L</span>

<span class="c">% Specifiy the time of simulation (in hours)</span>
<span class="n">finalTime</span> <span class="p">=</span> <span class="mi">1</span><span class="p">;</span>

<span class="c">% Run simulation</span>
<span class="n">simulationRes</span> <span class="p">=</span> <span class="n">simulateEnsemble</span><span class="p">(</span><span class="n">ensemble</span><span class="p">,</span> <span class="n">finalTime</span><span class="p">,</span> <span class="n">enzymesIC</span><span class="p">,</span> <span class="n">metsIC</span><span class="p">,</span> <span class="n">metsAbsOrRel</span><span class="p">,</span> <span class="n">interruptTime</span><span class="p">);</span>

<span class="c">% Save the results</span>
<span class="n">save</span><span class="p">(</span><span class="n">fullfile</span><span class="p">(</span><span class="n">outputFolder</span><span class="p">,</span> <span class="p">[</span><span class="s">&#39;simulation_&#39;</span><span class="p">,</span> <span class="n">modelID</span><span class="p">,</span> <span class="s">&#39;.mat&#39;</span><span class="p">]),</span> <span class="s">&#39;simulationRes&#39;</span><span class="p">)</span>
<span class="n">write</span><span class="p">(</span><span class="n">cell2table</span><span class="p">(</span><span class="n">ensemble</span><span class="p">.</span><span class="n">mets</span><span class="p">(</span><span class="n">ensemble</span><span class="p">.</span><span class="n">metsActive</span><span class="p">)),</span> <span class="n">fullfile</span><span class="p">(</span><span class="n">outputFolder</span><span class="p">,</span> <span class="p">[</span><span class="n">modelID</span><span class="p">,</span> <span class="s">&#39;_metsActive.dat&#39;</span><span class="p">]));</span>
<span class="n">write</span><span class="p">(</span><span class="n">cell2table</span><span class="p">(</span><span class="n">ensemble</span><span class="p">.</span><span class="n">rxns</span><span class="p">(</span><span class="n">ensemble</span><span class="p">.</span><span class="n">activeRxns</span><span class="p">)),</span> <span class="n">fullfile</span><span class="p">(</span><span class="n">outputFolder</span><span class="p">,</span> <span class="p">[</span><span class="n">modelID</span><span class="p">,</span> <span class="s">&#39;_rxnsActive.dat&#39;</span><span class="p">]));</span>
</pre></div>
</div>
<p>The resulting Matlab structure contains the following fields:</p>
<blockquote>
<div><ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">t</span></code>: time points in each model simulation;</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">conc</span></code>: concentrations for each time point and model simulation;</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">flux</span></code>: fluxes for each time point and model simulation.</p></li>
</ul>
</div></blockquote>
<p>To visualize the simulation results you can use the jupyter notebook <code class="docutils literal notranslate"><span class="pre">visualize_simulations.ipynb</span></code> in the <code class="docutils literal notranslate"><span class="pre">visualization</span></code> folder. More details about this notebook can be found in the <a class="reference internal" href="visualization.html#visualization-python"><span class="std std-ref">Visualizing results</span></a> section.</p>
</div>
<div class="section" id="metabolic-control-analysis-mca">
<h2>Metabolic Control Analysis (MCA)<a class="headerlink" href="#metabolic-control-analysis-mca" title="Permalink to this headline">¶</a></h2>
<p>To do Metabolic Control Analysis (MCA) on the model ensemble you can use the <code class="docutils literal notranslate"><span class="pre">MCA_analysis.m</span></code> script in the <code class="docutils literal notranslate"><span class="pre">examples</span></code> folder.</p>
<p>This will perform MCA on the model ensemble and give the average flux and concentration control coefficients over all models in the ensemble.</p>
<p>If the variable <code class="docutils literal notranslate"><span class="pre">saveMCAMatrices</span></code> is set to <code class="docutils literal notranslate"><span class="pre">1</span></code> it wil also return the control coefficients for each individual model. This can be useful to do further analysis. However, due to memory requirements it can make the calculation very slow for larger models (&gt; 40 reactions).</p>
<p>The resulting Matlab structure contains the following fields:</p>
<blockquote>
<div><ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">xControlAvg</span></code>: average concentration control coefficient for each model ensemble;</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">vControlAvg</span></code>: average flux control coefficient for each model ensemble;</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">xcounter</span></code>: number of models in the average concentration control coefficient calculation;</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">vcounter</span></code>: number of models in the average flux control coefficient calculation;</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">xControl</span></code>: concentration control coefficient matrix for each model;</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">vControl</span></code>: flux control coefficient matrix for each model;</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">E_x_nor</span></code>: normalized elasticity matrix for each model.</p></li>
</ul>
</div></blockquote>
<p>Example:</p>
<div class="highlight-matlab notranslate"><div class="highlight"><pre><span></span><span class="c">% Add all GRASP functions to Matlab&#39;s path</span>
<span class="n">addpath</span><span class="p">(</span><span class="n">fullfile</span><span class="p">(</span><span class="s">&#39;..&#39;</span><span class="p">,</span> <span class="s">&#39;matlab_code&#39;</span><span class="p">,</span> <span class="s">&#39;patternFxns&#39;</span><span class="p">),</span> <span class="c">...</span>
        <span class="n">fullfile</span><span class="p">(</span><span class="s">&#39;..&#39;</span><span class="p">,</span> <span class="s">&#39;matlab_code&#39;</span><span class="p">,</span> <span class="s">&#39;ensembleFxns&#39;</span><span class="p">));</span>

<span class="c">% Whether or not to save the MCA results for all models and not just mean values</span>
<span class="n">saveMCAMatrices</span> <span class="p">=</span> <span class="mi">1</span><span class="p">;</span>

<span class="c">% Define the model ID (file name of the model ensemble)</span>
<span class="n">modelID</span> <span class="p">=</span> <span class="s">&#39;toy_model&#39;</span><span class="p">;</span>

<span class="c">% Define the path to the input/output files</span>
<span class="n">outputFolder</span> <span class="p">=</span> <span class="n">fullfile</span><span class="p">(,</span> <span class="s">&#39;..&#39;</span><span class="p">,</span> <span class="s">&#39;io&#39;</span><span class="p">,</span> <span class="s">&#39;output&#39;</span><span class="p">);</span>

<span class="c">% Load previously generated model ensemble</span>
<span class="n">load</span><span class="p">(</span><span class="n">fullfile</span><span class="p">(</span><span class="n">outputFolder</span><span class="p">,</span> <span class="p">[</span><span class="n">modelID</span><span class="p">,</span> <span class="s">&#39;.mat&#39;</span><span class="p">]))</span>

<span class="c">% Run MCA analysis</span>
<span class="n">mcaResults</span> <span class="p">=</span> <span class="n">controlAnalysis</span><span class="p">(</span><span class="n">ensemble</span><span class="p">,</span> <span class="n">saveMCAMatrices</span><span class="p">);</span>

<span class="c">% Save MCA results</span>
<span class="n">save</span><span class="p">(</span><span class="n">fullfile</span><span class="p">(</span><span class="n">outputFolder</span><span class="p">,</span> <span class="p">[</span><span class="s">&#39;MCA_&#39;</span><span class="p">,</span> <span class="n">modelID</span><span class="p">,</span> <span class="s">&#39;.mat&#39;</span><span class="p">]),</span> <span class="s">&#39;mcaResults&#39;</span><span class="p">);</span>
<span class="n">write</span><span class="p">(</span><span class="n">cell2table</span><span class="p">(</span><span class="n">ensemble</span><span class="p">.</span><span class="n">rxns</span><span class="p">(</span><span class="n">ensemble</span><span class="p">.</span><span class="n">activeRxns</span><span class="p">)),</span> <span class="n">fullfile</span><span class="p">(</span><span class="n">outputFolder</span><span class="p">,</span> <span class="p">[</span><span class="n">modelID</span><span class="p">,</span> <span class="s">&#39;_rxnsActive.dat&#39;</span><span class="p">]));</span>
<span class="n">write</span><span class="p">(</span><span class="n">cell2table</span><span class="p">(</span><span class="n">ensemble</span><span class="p">.</span><span class="n">mets</span><span class="p">(</span><span class="n">ensemble</span><span class="p">.</span><span class="n">metsActive</span><span class="p">)),</span> <span class="n">fullfile</span><span class="p">(</span><span class="n">outputFolder</span><span class="p">,</span> <span class="p">[</span><span class="n">modelID</span><span class="p">,</span> <span class="s">&#39;_metsActive.dat&#39;</span><span class="p">]));</span>
<span class="n">write</span><span class="p">(</span><span class="n">cell2table</span><span class="p">(</span><span class="n">mcaResults</span><span class="p">.</span><span class="n">enzNames</span><span class="p">),</span> <span class="n">fullfile</span><span class="p">(</span><span class="n">outputFolder</span><span class="p">,</span> <span class="p">[</span><span class="n">modelID</span><span class="p">,</span> <span class="s">&#39;_enzNames.dat&#39;</span><span class="p">]));</span>

<span class="c">% Plot MCA results - optional</span>

<span class="c">% Optional, Define ranges for displaying the MCA results``:  {1st category, range; 2nd category, range}</span>
<span class="c">% For example, categories = {&#39;Glycolysis&#39;,[1,20]; &#39;Pentose Phosphate Pathway&#39;,[21,30];&#39;Others&#39;, [31,37]};</span>
<span class="n">categories</span> <span class="p">=</span> <span class="p">{</span><span class="s">&#39;all&#39;</span><span class="p">,</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">5</span><span class="p">]};</span>

<span class="n">plotControlAnalysis</span><span class="p">(</span><span class="n">mcaResults</span><span class="p">,</span> <span class="n">ensemble</span><span class="p">,</span> <span class="n">categories</span><span class="p">);</span>
</pre></div>
</div>
<p>If you have promiscuous enzymes in your model, you should do response analysis instead of simple control analysis.</p>
<p>This is because an increase of the promiscuous enzyme concentration doesn’t necessarily lead to an equal increase in the flux of the reactions it catalyzes.</p>
<p>Response and control coefficients are the same when enzymes are independent and an increase in enzyme concentration leads to a proportional increase in the reaction flux.</p>
<p>Response coefficients are calculated as:</p>
<div class="math notranslate nohighlight">
\[C_E^J = C_v^J\Pi\]</div>
<p>where <span class="math notranslate nohighlight">\(C_v^J\)</span> is the flux control coefficient matrix and <span class="math notranslate nohighlight">\(\Pi\)</span> is the parameter elasticity matrix.</p>
<p>The implementation is based on</p>
<blockquote>
<div><ul class="simple">
<li><p><a class="reference external" href="https://doi.org/10.1002/9780470475935.ch3">https://doi.org/10.1002/9780470475935.ch3</a>, section on MCA;</p></li>
<li><p><a class="reference external" href="https://doi.org/10.1111/j.1432-1033.1990.tb15329.x">https://doi.org/10.1111/j.1432-1033.1990.tb15329.x</a>;</p></li>
<li><p><a class="reference external" href="https://doi.org/10.1111/j.1432-1033.1990.tb15330.x">https://doi.org/10.1111/j.1432-1033.1990.tb15330.x</a>.</p></li>
</ul>
</div></blockquote>
<p>You can do response analysis by using the functions <code class="docutils literal notranslate"><span class="pre">controlAndResponseAnalysis</span></code> instead of <code class="docutils literal notranslate"><span class="pre">controlAnalysis</span></code> and <code class="docutils literal notranslate"><span class="pre">plotControlAndResponseAnalysis</span></code> instead of <code class="docutils literal notranslate"><span class="pre">plotControlAnalysis</span></code>.</p>
<p>To visualize the results you can use the jupyter notebook <code class="docutils literal notranslate"><span class="pre">visualize_mca.ipynb</span></code> in the <code class="docutils literal notranslate"><span class="pre">visualization</span></code> folder. For more details see the <a class="reference internal" href="visualization.html#visualization-python"><span class="std std-ref">Visualizing results</span></a> section.</p>
</div>
<div class="section" id="stability-analysis">
<h2>Stability analysis<a class="headerlink" href="#stability-analysis" title="Permalink to this headline">¶</a></h2>
<p>To do stability analysis you can use the <code class="docutils literal notranslate"><span class="pre">stability_analysis.m</span></code> script in the <code class="docutils literal notranslate"><span class="pre">examples</span></code> folder.</p>
<p>This basically calculates the jacobian of every model in the ensemble and checks if the real part of its eigenvalues is higher than the given threshold, <code class="docutils literal notranslate"><span class="pre">eigThreshold</span></code>.</p>
<p>If the specified threshold is the same as the one specified when building the model ensemble, all models will be considered stable, since only stable models are returned by GRASP when building the model ensemble.</p>
<p>The returned Matlab structure has the following fields:</p>
<blockquote>
<div><ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">posEig</span></code>: positive eigenvalues for unstable models;</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">unstableModels</span></code>: list of unstable models.</p></li>
</ul>
</div></blockquote>
<p>Example:</p>
<div class="highlight-matlab notranslate"><div class="highlight"><pre><span></span><span class="c">% Add all GRASP functions to Matlab&#39;s path</span>
<span class="n">addpath</span><span class="p">(</span><span class="n">fullfile</span><span class="p">(</span><span class="s">&#39;..&#39;</span><span class="p">,</span> <span class="s">&#39;matlab_code&#39;</span><span class="p">,</span> <span class="s">&#39;patternFxns&#39;</span><span class="p">),</span> <span class="c">...</span>
        <span class="n">fullfile</span><span class="p">(</span><span class="s">&#39;..&#39;</span><span class="p">,</span> <span class="s">&#39;matlab_code&#39;</span><span class="p">,</span> <span class="s">&#39;ensembleFxns&#39;</span><span class="p">));</span>

<span class="c">% Whether or not to save the MCA results for all models and not just mean values</span>
<span class="n">saveMCAMatrices</span> <span class="p">=</span> <span class="mi">1</span><span class="p">;</span>

<span class="c">% Define the model ID (file name of the model ensemble)</span>
<span class="n">modelID</span> <span class="p">=</span> <span class="s">&#39;toy_model&#39;</span><span class="p">;</span>

<span class="c">% Define the path to the input/output files</span>
<span class="n">outputFolder</span> <span class="p">=</span> <span class="n">fullfile</span><span class="p">(,</span> <span class="s">&#39;..&#39;</span><span class="p">,</span> <span class="s">&#39;io&#39;</span><span class="p">,</span> <span class="s">&#39;output&#39;</span><span class="p">);</span>

<span class="c">% threshold of the jacobian&#39;s eigenvalues</span>
<span class="n">eigThreshold</span> <span class="p">=</span> <span class="mi">10</span>^<span class="o">-</span><span class="mi">5</span><span class="p">;</span>

<span class="c">% Load the model ensemble generated by GRASP</span>
<span class="n">load</span><span class="p">(</span><span class="n">fullfile</span><span class="p">(</span><span class="n">outputFolder</span><span class="p">,</span> <span class="p">[</span><span class="n">modelID</span><span class="p">,</span> <span class="s">&#39;.mat&#39;</span><span class="p">]));</span>

<span class="c">% Run stability analysis</span>
<span class="n">stabilityRes</span> <span class="p">=</span> <span class="n">ensembleStabilityTest</span><span class="p">(</span><span class="n">ensemble</span><span class="p">,</span> <span class="n">eigThreshold</span><span class="p">);</span>

<span class="c">% Save the results</span>
<span class="n">save</span><span class="p">(</span><span class="n">fullfile</span><span class="p">(</span><span class="n">outputFolder</span><span class="p">,</span> <span class="p">[</span><span class="s">&#39;stability_&#39;</span><span class="p">,</span> <span class="n">modelID</span><span class="p">,</span> <span class="s">&#39;.mat&#39;</span><span class="p">]),</span> <span class="s">&#39;stabilityRes&#39;</span><span class="p">);</span>
</pre></div>
</div>
</div>
</div>


           </div>
           <div class="articleComments">
            
           </div>
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="visualization.html" class="btn btn-default float-right" title="Visualizing results" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="how_to_build_a_model.html" class="btn btn-default" title="How to build a model" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2016-2019, The GRASP developers.

    </p>
  </div>
  Built with Sphinx using a <a href="https://github.com/snide/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  

  

    <script type="text/javascript">
        var DOCUMENTATION_OPTIONS = {
            URL_ROOT:'./',
            VERSION:'2.0.0',
            COLLAPSE_INDEX:false,
            FILE_SUFFIX:'.html',
            HAS_SOURCE:  true,
            SOURCELINK_SUFFIX: '.txt'
        };
    </script>
    <script type="text/javascript" src="_static/jquery.js"></script>
    <script type="text/javascript" src="_static/underscore.js"></script>
    <script type="text/javascript" src="_static/doctools.js"></script>
    <script type="text/javascript" src="_static/language_data.js"></script>
    <script type="text/javascript" src="https://cdn.jsdelivr.net/gh/mathjax/MathJax@2.7.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>

  


  
  
    <script type="text/javascript" src="_static/js/theme.js"></script>
  

  
  
  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.StickyNav.enable();
      });
  </script>
   

</body>
</html>