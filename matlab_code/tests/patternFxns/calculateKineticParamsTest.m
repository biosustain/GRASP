classdef calculateKineticParamsTest < matlab.unittest.TestCase

    methods (Test)
        function testCalculateKineticParamsOrdBiBiInhib(testCase)
            
            randomRev = [0.232703192180917;1;0.0111503470662891;0.00792839605742630;...
                         0.297702857382776;1.62395177256284e-06];
            forwardFlux = [1,2;1,3;2,4;4,5;5,6;6,1];
            reactionFlux = [7.18745115052977];
            randomEnzymes = [0.101169325355362;0.178995493443313;0.247725507912171;...
                             0.345220798948209;0.101021233845777;0.0258676404951688];
            Nelem = [1;0;1;1;1;1];
            branchFactor = [1];
            modifierElemFlux = [0.166031664611764;0.166031664611764];
            rxnIsPromiscuous = 0;
            
            K = calculateKineticParams(randomRev,forwardFlux,reactionFlux,...
                                       randomEnzymes,Nelem,branchFactor,...
                                       modifierElemFlux,rxnIsPromiscuous);
                                   
            trueRes = [92.5896965357923;12.1778819171465;11.7955168194165;4.81720469117491;...
                       40.6071531723142;0.234766471555988;20.9862544260535;0.568596988732965;...
                       101.307438830463;117.782343482323;277.855370069997;0.000115371857527259];
                   
            testCase.verifyLessThanOrEqual(abs(trueRes - K), abs(trueRes*10^-14));   
        end
        
        function testCalculateKineticParamsOrdBiBi(testCase)
            
            randomRev = [0.990164244455958;0.689152057847595;0.802067021478711;...
                         0.954311262084314;0.807784093426579];
            forwardFlux = [1,2;2,3;3,4;4,5;5,1];
            reactionFlux = [6.84865633256387];
            randomEnzymes = [0.00415017918544730;0.262552829760635;...
                             0.357972658702502;0.132153043674154;0.243171288677262];
            Nelem = [1;1;1;1;1];
            branchFactor = [1];
            modifierElemFlux = [];
            rxnIsPromiscuous = 0;
            
            K = calculateKineticParams(randomRev,forwardFlux,reactionFlux,...
                                       randomEnzymes,Nelem,branchFactor,...
                                       modifierElemFlux,rxnIsPromiscuous);
                                   
            trueRes = [167776.372196579;2625.96046668436;83.9152076702939;...
                       42.4153033258375;96.6579002321143;210.000681229523;...
                       1134.27678160171;588.266293702467;146.522308722129;...
                       6934.96859130477];
                   
            testCase.verifyLessThanOrEqual(abs(trueRes - K), abs(trueRes*10^-14));   
            
        end
        function testCalculateKineticParamsOrdBiBiInhibPromiscuous(testCase)
            
            randomRev = [0.989289394819034;0;0.998928838354675;0.992228099640700;...
                         0.991025431010673;0.999554444189314;0.354088618614336;0;...
                         0.563569423420444;0.214127077647738;0.00301403057963057;...
                         0.125952621085079];
            forwardFlux = [1,2;2,3;2,4;4,5;5,6;6,1;1,7;7,8;7,9;9,10;10,11;11,1];
            reactionFlux = [6.84426224879727];
            randomEnzymes = [0.00290918111908902;0.162286314132289;0.0368866655185069;...
                             0.201442791408277;0.00675805067958089;0.0465061151971916;...
                             0.144973039337920;0.0391019175486528;0.104558509340513;...
                             0.100341398136524;0.154236017581456];
            Nelem = [1,0;0,0;1,0;1,0;1,0;1,0;0,1;0,0;0,1;0,1;0,1;0,1];
            branchFactor = [1,-0.000354581570642530];
            modifierElemFlux = [0.567897940747956,0.659410306523548;0.567897940747956,0.659410306523548];
            rxnIsPromiscuous = 1;
            
            K = calculateKineticParams(randomRev,forwardFlux,reactionFlux,...
                                       randomEnzymes,Nelem,branchFactor,...
                                       modifierElemFlux,rxnIsPromiscuous);
                                   
            trueRes = [219655.393283219;3895.41819331417;23.9505250816317;...
                       105.372561666785;39372.2044473166;31685.0537671157;...
                       4371.67317719924;129297.311772320;112847.410332529;...
                       16251.2876561132;330304.482129664;5277888.65845181;...
                       0.457310392968870;0.0259168741720196;31.1311474741667;...
                       115.420862974083;0.0216166210785428;0.0531824387236728;...
                       0.00632415758301937;0.0307758692337660;7.31174877306043e-05;...
                       0.0157822148625529;0.00226740569463890;0.954414582313796];
                   
            testCase.verifyLessThanOrEqual(abs(trueRes - K), abs(trueRes*10^-14));   
            
        end
    end
end

